---
# tasks file for app-tier
- name: install tomcat
  yum:
   name: tomcat
   state: latest

- name: enable tomcat at boot
  service:
   name: tomcat
   enabled: yes
   
- name: start
  service:
    name: tomcat
    state: started

- name: create tomcat default web directory
  file:
   path: "{{tomcat_web_root }}"
   state: directory

- name: create ansible webapps/ansible directory
  file:
    path: /usr/share/tomcat/webapps/ansible
    state: directory


- name: copy static index.html to tomcat weroot
  template:
   src: index.html.j2
   dest: "{{ tomcat_web_root}}/index.html"
  notify: restart tomcat
  
- name: copy static index.html to tomcat webapps/ansible/index.html
  become: true
  template:
    force: yes
    src: index.html.j2
    dest: /usr/share/tomcat/webapps/ansible/index.html
  notify: restart tomcat
